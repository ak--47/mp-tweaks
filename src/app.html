<!DOCTYPE html>
<html>

<head>
    <title>MP Tweaks!</title>
    <link href="styles.css" rel="stylesheet">
</head>

<body>
<div id="app">
<div id="mainPopup">
	<h1>MP Tweaks</h1>            
</div>
   
		<!-- LOADER -->
		<div id="loader">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-rolling" style="background: none;">
				<circle cx="50" cy="50" fill="none" ng-attr-stroke="{{config.color}}" ng-attr-stroke-width="{{config.width}}" ng-attr-r="{{config.radius}}" ng-attr-stroke-dasharray="{{config.dasharray}}" stroke-width="4" r="30" stroke-dasharray="141.37166941154067 49.12388980384689" transform="rotate(72.4232 50 50)">
					<animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1.9s" begin="0s" repeatCount="indefinite"></animateTransform>
				</circle>
			</svg>
		</div>

		<!-- REST OF APP -->
		<div id="main" class="hidden">

		<!-- MOD HEADER -->
		<div id="modHeader" class="section">
		<h2 class="lower">Mod Header</h2>
		<p class="small">inject <b>custom headers</b> into <b>all requests</b> for <b>all tabs</b> &emsp; &emsp; &emsp; <span id="modHeaderLabel" class="statusText hidden">mod header is: <b>FOO</b></span></p>
		<div class="controls" id="userHeaders">
			<input class="checkPair" type="checkbox"/> <input class="headerKey" placeholder="x-imp" value="x-imp" type="text"/> : <input class="headerValue" type="text"/> <button class="deletePair">-</button> <br/>
			<input class="checkPair" type="checkbox"/> <input class="headerKey" placeholder="x-profile" value="x-profile" type="text"/> : <input class="headerValue" type="text"/> <button class="deletePair">-</button> <br/>
			<input class="checkPair" type="checkbox"/> <input class="headerKey" placeholder="x-assets-commit" value="x-assets-commit" type="text"/> : <input class="headerValue" type="text"/> <button class="deletePair">-</button> <br/>
			&emsp; &emsp;<button id="addHeader">+</button>&emsp; &emsp; &emsp; &emsp; &emsp;<button id="saveHeaders">refresh</button> : <button id="clearHeaders">clear</button><br/>
			
		</div>
		</div>
	
		<!-- FEATURE FLAGS -->
		<div id="perTab" class="section">
			<h2 class="lower">Feature Flags</h2>
			<p class="small">inject <b>feature flags</b> into the <b>active tab</b></p>
			<div id="buttons">
			</div>
			<button class="button fa remove" id="removeAll">REMOVE ALL FLAGS</button>
		</div>


		<!-- SESSION REPLAY -->
		<div id="sessionReplay" class="section">
            <h2 class="lower">Session Replay</h2>
            <p class="small">records your screen in <b>current tab</b>&emsp; &emsp; &emsp; <span id="sessionReplayLabel" class="statusText hidden">Session Replay is: <b>FOO</b></span></p>
			<input class="tokenEntry" type="text" id="sessionReplayToken" placeholder="Mixpanel Project Token" />
			<div class="button-input-group">
				<button class="button fa" id="startReplay">START RECORDING</button> 
				<button class="button fa" id="stopReplay">STOP RECORDING</button> 				
			</div>
        </div>
			
		<!-- EZTRACK -->
		<div id="EZTrack" class="section hidden off">
            <h2 class="lower">EZTrack</h2>
            <p class="small">inject <b>eztrack</b> into <b>current tab</b>&emsp; &emsp; &emsp; <span id="EZTrackLabel" class="statusText hidden">EZTrack is: <b>FOO</b></span></p>
			<input type="text" class="tokenEntry" id="EZTrackToken" placeholder="Mixpanel Project Token" />
			<div class="button-input-group">
				<button class="button fa" id="startEZTrack">START EZTRACK</button> 
				<button class="button fa" id="stopEZTrack">STOP EZTRACK</button> 
			</div>
        </div>

		<!-- CREATE PROJECTS -->
		<div id="createProject" class="section">
			<h2>Project Creator</h2>
			<p class="small">make a <b>new project</b> in <b>your personal org</b> &emsp; &emsp; &emsp; <span id="orgLabel" class="statusText hide">connected org: <b>FOO</b></span></p>
			<button class="button fa" id="makeProject">MAKE PROJECT</button> 
				<svg id="makeProjectSpinner" class="hidden" width="50px" height="50px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-rolling" style="background: none;">
					<circle cx="50" cy="50" fill="none" ng-attr-stroke="{{config.color}}" ng-attr-stroke-width="{{config.width}}" ng-attr-r="{{config.radius}}" ng-attr-stroke-dasharray="{{config.dasharray}}" stroke="#DF7800" stroke-width="4" r="30" stroke-dasharray="141.37166941154067 49.12388980384689" transform="rotate(72.4232 50 50)">
						<animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1.9s" begin="0s" repeatCount="indefinite"></animateTransform>
					</circle>
				</svg>
			
				<div id="projectDetails">
					<p><textarea class="hidden" id="apiRes" style="height: 200px; width: 90%;"></textarea></p>
				</div>
	
		</div>
 

		<!-- CHART EDITOR -->	
		<div id="dataEditor" class="section">
			<h2>Chart Editor / API Query Builder</h2>
			<p class="small"><b>change the data</b> for a chart in the <b>active tab</b><br/>
			or <b>construct an query API payload</b> for the chart in the <b>active tab</b></p>
			<div class="controls">
				<button class="button fa" id="fetchChartData">FETCH CHART DATA</button>
				<button class="button fa" id="buildChartPayload">CONSTRUCT API QUERY</button>
				<button class="button fa hidden" id="postChartData">REDRAW CHART</button>
				<button class="button fa hidden" id="randomize">RANDOMIZE</button>
				<button class="button fa hidden" id="saveChartData">SAVE</button>
				<button class="button fa hidden" id="resetDataEditor">RESET</button>
				<p class="hidden" id="lastChart"><a href="#" target="_top">last used report</a></p>
				<p class="error hidden" id="contextError">extension context invalidated; please refresh the page and try again</p>
				<p class="error hidden" id="badJSON">your JSON is not valid; make it valid and try again</p>
				<div id="rawDataWrapper" class="hidden">
					<textarea id="rawData"></textarea>
				</div>
			</div>
		</div>

		<!-- PERSISTENT SCRIPTS -->
		<div id="persistentOptions" class="section">
            <form>
                <h2>Persistent Options</h2>
                <p class="small">always active on <b>all mixpanel tabs</b> when enabled</p>

                <div class="controls">
                   
					<div class="option">
                        <label><input class='toggle' type="checkbox" name='check-1' id="hideBanners">
                        </input>hide banners + outage notifs</label>
                    </div>
                    
					<div class="option">
						<label> <input class='toggle' type="checkbox" name='check-1' id="renameTabs">
                        </input>concise browser tab titles</label>
                    </div>
					
					<div class="option">
						<label>
							<input class='toggle' type="checkbox" name='check-1' id="hundredX">
                        </input>100x all charts</label>
                    </div>

                </div>

            </form>
        </div>


		<!-- ODDS N ENDS -->
		<div id="oddsEnds" class="section">
			<h2 class="lower">Odds and Ends</h2>
			<p class="small">some <b>random stuff</b> that is helpful			
			<div class="button-input-group">
				<button class="button fa" id="nukeCookies">NUKE COOKIES</button> 
			</div>
		</div>

            
		<!-- FOOTER -->
		<div id="footer">
            <p class="addMore"><a href="https://docs.google.com/spreadsheets/d/1NPOk9MpGrvA8ruFVv2AToMnL_Yt_Mz8jN52vE89MQ1U/edit#gid=0&range=A1" target="_blank">add a new feature flag</a></p>
            <p class="byline"><a href="https://forms.gle/sn4aYQAnMEihbwvs8" target="_blank">request a feature</a>          
        </div>
    </div>

</div>

<!-- SCRIPTS -->
<script src="./lib/saveFile.min.js"></script>
<script src="./lib/papaparse.min.js"></script>
<script src="./lib/mixpanel-wrapper.js"></script>
<script src="./lib/mixpanel.min.js"></script>
<script type="module" src="./app.js"></script>
</body>

</html>