<!DOCTYPE html>
<html>

<head>
	<title>MP Tweaks!</title>
	<link href="styles.css"
		rel="stylesheet">
</head>

<body>
	<div id="app">
		<div id="mainPopup">
			<h1><a href="https://www.notion.so/mxpnl/MP-Tweaks-8d698b871a254890ab703c7f35cc4fa0?source=copy_link" target="_blank" class="logo-link">
				<lottie-player 
					src="./assets/limited-seg.lottie"
					background="transparent"
					speed="3"
					style="width: 42px; height: 42px; display: inline-block; vertical-align: middle; margin-right: 3px; opacity: 1;"
					loop 
					autoplay>
				</lottie-player> MP Tweaks
			</a></h1>
		</div>

		<!-- LOADER -->
		<div id="loader">
			<lottie-player 
				src="./assets/limited-seg.lottie"
				background="transparent"
				speed="1"
				style="width: 175px; height: 175px;"
				loop 
				autoplay>
			</lottie-player>
		</div>

		<!-- REST OF APP -->
		<div id="main"
			class="hidden">

			<!-- MOD HEADER -->
			<div id="modHeader"
				class="section">
				<h2 class="lower">&#128736;&#65039; Mod Header</h2>
				<p class="small">inject <b>custom headers</b> into <span class="highlight">all requests for all mixpanel.com tabs</span></p>
				<p class="status-line"><span id="modHeaderLabel"
						class="statusText">mod header is: <b>FOO</b></span></p>
				<div class="controls"
					id="userHeaders">
					<div class="row"><input class="checkPair"
							type="checkbox" /> <input class="headerKey"
							placeholder="x-imp"
							value="x-imp"
							type="text" /> : <input class="headerValue"
							type="text" /> <button class="deletePair">-</button> <br /></div>
					<div class="row"><input class="checkPair"
							type="checkbox" /> <input class="headerKey"
							placeholder="x-profile"
							value="x-profile"
							type="text" /> : <input class="headerValue"
							type="text" /> <button class="deletePair">-</button> <br /></div>
					<div class="row"><input class="checkPair"
							type="checkbox" /> <input class="headerKey"
							placeholder="x-assets-commit"
							value="x-assets-commit"
							type="text" /> : <input class="headerValue"
							type="text" /> <button class="deletePair">-</button> <br /></div>
				</div>
				<div class="button-input-group">
					<button class="button" id="addHeader">+ Add Header</button>
					<button class="button" id="saveHeaders">Refresh</button>
					<button class="button remove" id="clearHeaders">Clear All</button>
				</div>
			</div>

			<!-- DEMO SEQUENCES -->
			<div id="demoLinks"
				class="section">
				<h2 class="lower">&#127916; Demo Sequences</h2>
				<p class="small">click each button below for easy <b>one-click demo setup</b> on <span class="highlight">active mixpanel.com tab</span></p>
				<div class="buttons">
				</div>
				<p class="addMore"><a
						href="https://docs.google.com/spreadsheets/d/1FSX3cNbBbTLh0piT7EQ3ceIO8coDAsNVA7O4hCEtoBk/edit#gid=0&range=A1"
						target="_blank">add a new demo sequence</a></p>
			</div>

			<!-- DATA TOOLS -->
			<div id="dataTools"
				class="section">
				<h2 class="lower">&#129302; Apps + Tools</h2>
				<p class="small">some <b>useful tools</b> for <span class="highlight">dummy data creation</span> and <span class="highlight">asset management</span></p>
				<div class="buttons"
					id="toolsWrapper">
					<!-- injected on init -->
				</div>
				<p class="addMore"><a
						href="https://docs.google.com/spreadsheets/d/1lR2Bu3_RLkE16xnlpB2SQJFc0DOtRaTU_TdJOX3NVGY/edit?usp=sharing"
						target="_blank">add a new tool</a></p>
			</div>

			<!-- CREATE PROJECTS -->
			<div id="createProject"
				class="section">
				<h2>&#128035; Project Creator</h2>
				<p class="small">make a <b>new project</b> in <span class="highlight">your personal org</span><br /><span
						id="orgLabel"
						class="statusText hidden">connected org: <b>FOO</b></span></p>
				<div class="button-input-group">
					<button class="button" id="makeProject">Make Project</button>
					<button class="button" id="resetUser">Reauth</button>
					<svg id="makeProjectSpinner"
						class="hidden"
						width="24px"
						height="24px"
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 100 100"
						preserveAspectRatio="xMidYMid"
						style="background: none;">
						<circle cx="50"
							cy="50"
							fill="none"
							stroke="#DF7800"
							stroke-width="4"
							r="30"
							stroke-dasharray="141.37166941154067 49.12388980384689"
							transform="rotate(72.4232 50 50)">
							<animateTransform attributeName="transform"
								type="rotate"
								calcMode="linear"
								values="0 50 50;360 50 50"
								keyTimes="0;1"
								dur="1.9s"
								begin="0s"
								repeatCount="indefinite"></animateTransform>
						</circle>
					</svg>
					<span id="projectStatus"></span>
				</div>

				<div id="projectDetails">
					<p><textarea class="hidden"
							id="apiRes"
							style="height: 200px; width: 90%;"></textarea></p>
				</div>

			</div>




			<!-- SESSION REPLAY -->
			<div id="sessionReplay"
				class="section">
				<h2 class="lower">&#128248; Session Replay / Autocapture</h2>
				<p class="small">autocaptures your screen in the <span class="highlight">current tab (any site)</span>&emsp; &emsp; &emsp; <span
						id="sessionReplayLabel"
						class="statusText hidden">Recording is: <b>FOO</b></span></p>
				<input class="tokenEntry"
					type="text"
					id="sessionReplayToken"
					placeholder="Mixpanel Project Token" />
				<div class="button-input-group">
					<button class="button" id="startReplay">Start Capture</button>
					<button class="button" id="stopReplay">Stop Capture</button>
				</div>
			</div>

			<!-- CHART EDITOR -->
			<div style="display: none;"
				id="dataEditor"
				class="section">
				<h2>&#128202; Chart Editor / API Query Builder</h2>
				<p class="small"><b>change the data</b> for a chart in the <b>active tab</b><br />
					or <b>construct an query API payload</b> for the chart in the <b>active tab</b></p>
				<div class="controls">
					<div class="buttons">
						<button class="button" id="fetchChartData">Fetch Chart Data</button>
						<button class="button" id="buildChartPayload">Construct API Query</button>
						<button class="button hidden" id="postChartData">Redraw Chart</button>
						<button class="button hidden" id="randomize">Randomize</button>
						<button class="button hidden" id="saveChartData">Save</button>
						<button class="button" id="resetDataEditor">Reset</button>
					</div>
					<p class="hidden"
						id="queryMetadata">
						<span>metadata</span>
						<a href="#"
							target="_top"
							class="hidden"
							id="apiUrl">api_url</a>
						<a href="#"
							target="_top"
							id="uiUrl">ui_url</a>
						<a href="#"
							target="_top"
							id="apiPayload">payload</a>
						<a href="#"
							target="_top"
							class="hidden"
							id="origResponse">original response</a>
					</p>
					<p class="error hidden"
						id="contextError">extension context invalidated; please refresh the page and try again</p>
					<p class="error hidden"
						id="badJSON">your JSON is not valid; make it valid and try again</p>
					<div id="rawDataWrapper"
						class="hidden">
						<textarea id="rawData"></textarea>
					</div>
					<div id="chartOverrides"
						class="section">
						<h2 class="lower">Saved Chart Overrides</h2>
						<p class="small">click a saved override to view its data</p>
						<div id="overrideList"></div>
					</div>

				</div>
			</div>


			<!-- FEATURE FLAGS -->
			<div id="perTab"
				class="section">
				<h2 class="lower">&#128681; Feature Flags</h2>
				<p class="small">inject <b>feature flags</b> into the <span class="highlight">active mixpanel.com tab</span></p>
				<div class="buttons">
				</div>
				<button class="button remove" id="removeAll">Remove All Flags</button>
				<p class="addMore"><a
						href="https://docs.google.com/spreadsheets/d/1NPOk9MpGrvA8ruFVv2AToMnL_Yt_Mz8jN52vE89MQ1U/edit#gid=0&range=A1"
						target="_blank">add a new feature flag</a></p>
			</div>


			<!-- PERSISTENT SCRIPTS -->
			<div id="persistentOptions"
				class="section">
				<form>
					<h2>&#128204; Persistent Options</h2>
					<p class="small">always active on <span class="highlight">all mixpanel tabs</span> when enabled</p>

					<div class="controls">

						<div class="option">
							<label><input class='toggle'
									type="checkbox"
									name='check-1'
									id="hideBanners">
								</input>hide banners + outage notifs</label>
						</div>

						<div class="option">
							<label><input class='toggle'
									type="checkbox"
									name='check-1'
									id="hideBetas">
								</input>hide beta + alpha labels</label>
						</div>

						<div class="option">
							<label> <input class='toggle'
									type="checkbox"
									name='check-1'
									id="renameTabs">
								</input>concise browser tab titles</label>
						</div>

						<div class="option">
							<label>
								<input class='toggle'
									type="checkbox"
									name='check-1'
									id="hundredX">
								</input>100x all charts</label>
						</div>

					</div>

				</form>
			</div>


			<!-- ODDS N ENDS -->
			<div id="oddsEnds"
				class="section">
				<h2 class="lower">&#127922; Odds and Ends</h2>
				<p class="small">some <b>random stuff</b> that is helpful for <span class="highlight">development and testing</span></p>
				<div class="button-input-group">
					<button class="button" id="nukeCookies">Nuke Cookies</button>
					<button class="button" id="embedSDK">Embed SDK</button>
				</div>
			</div>


			<!-- FOOTER -->
			<div id="footer">

				<p>
					<span>version <span id="versionLabel">{{version}}</span> made with &#129392; by <a
							href="https://github.com/ak--47/mp-tweaks"
							target="_blank">AK</a></span>
					<a class="byline"
						href="https://forms.gle/sn4aYQAnMEihbwvs8"
						target="_blank">request a feature</a>
				</p>
			</div>
		</div>

	</div>

	<!-- SCRIPTS -->
	<script src="./lib/lottie-player.js"></script>
	<script src="./lib/saveFile.js"></script>
	<script src="./lib/papaparse.js"></script>
	<script src="./lib/mixpanel-wrapper.js"></script>
	<script src="./lib/mixpanel-full.js"></script>
	<script type="module"
		src="./app.js"></script>
</body>

</html>